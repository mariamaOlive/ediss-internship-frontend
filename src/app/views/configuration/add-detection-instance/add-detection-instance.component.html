<div class="ms-3 mb-3 d-flex justify-content-start align-items-center">
  <a (click)="navigateBack()" class="icon-back">
    <svg cIcon class="my-1 text-secondary" name="cilArrowCircleLeft" width="40"></svg>
  </a>
  <span class="text-secondary fs-3 ms-3">Add New Detection Instance</span>
</div>

<c-card class="mb-5 shadow">
  <!-- Header -->
  <c-card-header>
    <c-container>
      <c-row>
        <c-col class="ps-4" sm="10" xs="8">
          <c-container>
            <c-row class="mt-4 mb-3">
              <h4 class="header__title p-0 fw-bolder">Add Detection Instance information</h4>
            </c-row>
          </c-container>
        </c-col>

      </c-row>

    </c-container>
  </c-card-header>

  <!-- Card body -->
  <c-card-body>
    <!-- Card 1 -->
    <c-card class="mb-3 mt-2">
      <c-card-body>
        <c-container>
          <c-row class="mt-3 small-card__title">
            <h6>Detection Instance name</h6>
          </c-row>
          <c-row class="mt-3">
            <form cForm class="p-0">
              <div>
                <input cFormControl placeholder="Type detection instance name" id="inputZoneName" type="text"
                  [(ngModel)]="detectionInstanceName" name="zoneName">
              </div>
            </form>
          </c-row>
        </c-container>
      </c-card-body>
    </c-card>

    <!-- Card 2 -->
    <!-- <c-card class="mb-3 mt-2">
      <c-card-body>
        <c-container>
          <c-row class="mt-3 small-card__title">
            <h6>Zone</h6>
          </c-row>
          <c-row class="mt-3">
            <select aria-label="Select an assignee" cSelect [(ngModel)]="selectedZone">
              <option value="" disabled>Select a zone</option>
              <option *ngFor="let zone of zones" [value]="zone.id">
                {{ zone.name }}
              </option>
            </select>
          </c-row>
        </c-container>
      </c-card-body>
    </c-card> -->

    <!-- Card 3 -->
    <!-- <c-card class="mb-3 mt-2">
      <c-card-body>
        <c-container>
          <c-row class="mt-3 small-card__title">
            <h6>Assignee</h6>
          </c-row>
          <c-row class="mt-3">
            <select aria-label="Select an assignee" cSelect [(ngModel)]="selectedAssignee">
              <option value="" disabled>Select an assignee</option>
              <option *ngFor="let assignee of assignees" [value]="assignee.name">
                {{ assignee.name }}
              </option>
            </select>
          </c-row>
        </c-container>
      </c-card-body>
    </c-card> -->

    <!-- Card 4 -->
    <c-card class="mb-3">
      <c-card-body>
        <c-container>
          <c-row class="mt-3 small-card__title">
            <h6>Hazard detection</h6>
          </c-row>

          <!-- Form confidence threshold -->
          <c-row class="mt-4 mb-2">
            <div>
              <form #numberForm="ngForm">
                <div class="mb-3">
                  <label for="numberInput" class="form-label">Confidence Level</label>
                  <div class="input-group confidence-input">
                    <input id="numberInput" type="number" min="0" max="100" [ngModel]="confidenceThreshold * 100"
                      (ngModelChange)="setConfidenceThreshold($event)" name="numberInput" required
                      class="form-control form-control-sm">
                    <span class="input-group-text">%</span>
                  </div>
                  <div
                    *ngIf="numberForm.controls['numberInput']?.invalid && numberForm.controls['numberInput']?.touched">
                    <small class="text-danger">Please enter a valid number between 0 and 100.</small>
                  </div>
                </div>
              </form>
            </div>
          </c-row>

          <!-- Detection type -->
          <c-row>
            <p class="mb-1">Detection type</p>
            <div class="d-flex flex-wrap">
              <c-form-check *ngFor="let type of detectionTypesList; let i = index" [class.ms-4]="i !== 0">
                <input cFormCheckInput type="radio" [value]="type.id" name="flexRadioDefault"
                  [(ngModel)]="selectedDetectionType" />
                <label cFormCheckLabel>{{ type.name }}</label>
              </c-form-check>
            </div>
          </c-row>
          
          <!-- Form PPE -->
          <c-row class="mt-4" *ngIf="selectedDetectionType === 1">
            <p class="mb-1">PPE Detection</p>
            <div class="d-flex flex-wrap">
              <div class="container__multiselect">
                <ng-multiselect-dropdown class="multiselect-element" [placeholder]="'Select Objects'"
                  [settings]="dropdownSettingsObjects" [data]="dropdownListObjects" [(ngModel)]="selectedItemsObjects">
                </ng-multiselect-dropdown>
              </div>
            </div>
          </c-row>
          

          <!-- <c-row class="mt-4" *ngIf="selectedDetectionType === '3'">
            <p class="mb-1">Fork Lift Minimum Distance</p>
            <div class="d-flex flex-wrap">
              <form cForm class="p-0">
                <div class="input-group">
                  <input cFormControl placeholder="Enter Forklift Minimum Distance" id="inputForkliftDistance"
                    type="number" [(ngModel)]="forkliftDistance" name="forkliftDistance">
                  <span class="input-group-text">meters</span>
                </div>
              </form>
            </div>
          </c-row> -->

        </c-container>
      </c-card-body>
    </c-card>

    <!-- Card 5 -->
    <c-card class="mb-4">
      <c-card-body>
        <c-container>
          <c-row class="mt-3 small-card__title">
            <h6>Cameras</h6>
          </c-row>
          <c-row class="mt-4">
            <div *ngFor="let camera of zone?.cameras" class="d-flex align-items-center mb-2">
              <c-form-check>
                <input 
                  cFormCheckInput 
                  type="radio" 
                  [value]="camera.id" 
                  name="flexRadioDefaultCamera" 
                  [(ngModel)]="selectedCameraId" 
                />
                <label cFormCheckLabel>{{ camera.name }} - {{ camera.ipaddress }}</label>
              </c-form-check>
            </div>
          </c-row>
        </c-container>
      </c-card-body>
    </c-card>
    
    <c-container class="d-flex justify-content-end align-items-center pe-0 mb-3">
      <button 
        cButton 
        color="secondary" 
        variant="ghost" 
        class="btn-cancel me-3" 
        (click)="navigateBack()">Cancel</button>

      <button 
        cButton 
        color="primary" 
        class="btn-add" 
        (click)="addNewDetectionInstance()">Start detection</button>
    </c-container>



  </c-card-body>
</c-card>